<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Comparativo de Planos – Interativo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Space+Grotesk:wght@700&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --bg: #0B1020;
            --card: #0F172A;
            --muted: #6B7280;
            --line: #334155;
            --brand: #5B8CFF;
            --ok: #22C55E;
            --accent: #F59E0B
        }

        body {
            font-family: Inter, system-ui, Segoe UI, Roboto, Helvetica, Arial
        }

        .title {
            font-family: 'Space Grotesk', Inter, system-ui
        }

        .shadow-soft {
            box-shadow: 0 10px 30px rgba(0, 0, 0, .35)
        }

        .table-sticky thead th {
            position: sticky;
            top: 0;
            background: #0F172A;
            z-index: 5
        }

        .cell-badge {
            display: inline-block;
            padding: .15rem .45rem;
            border: 1px solid #334155;
            border-radius: .5rem;
            background: #0B1222
        }

        /* Tooltips */
        .tooltip {
            position: relative;
            display: inline-flex;
            align-items: center;
            gap: .35rem
        }

        .tooltip .info-dot {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 18px;
            height: 18px;
            border: 1px solid var(--line);
            border-radius: 9999px;
            color: #9ca3af;
            font-size: .7rem;
            cursor: help
        }

        .tooltip .tip {
            position: absolute;
            left: 0;
            bottom: calc(100% + 6px);
            max-width: 280px;
            background: var(--card);
            border: 1px solid var(--line);
            padding: .5rem .6rem;
            border-radius: .5rem;
            color: #cbd5e1;
            font-size: .75rem;
            line-height: 1.15;
            opacity: 0;
            transform: translateY(6px);
            pointer-events: none;
            transition: .2s;
            z-index: 10
        }

        .tooltip:focus-within .tip,
        .tooltip:hover .tip {
            opacity: 1;
            transform: translateY(0)
        }

        .tip:after {
            content: "";
            position: absolute;
            top: 100%;
            left: 10px;
            border: 6px solid transparent;
            border-top-color: var(--line)
        }

        .tip kbd {
            background: #111827;
            border: 1px solid #1f2937;
            border-radius: .25rem;
            padding: 0 .25rem;
            font-family: ui-monospace, Menlo, Consolas, monospace
        }

        @media print {

            header,
            #controls {
                display: none
            }

            body {
                background: #fff;
                color: #111
            }

            table {
                font-size: 12px
            }
        }
    </style>
</head>

<body class="min-h-screen bg-[var(--bg)] text-slate-100">
    <header class="px-6 md:px-10 py-8">
        <h1 class="title text-3xl md:text-4xl font-bold">Comparativo de Planos – EIAH</h1>
        <p class="text-slate-300 mt-2">Tabela interativa por tópico e descrição de cada plano. Filtre, oculte colunas,
            exporte CSV/JSON ou imprima.</p>
    </header>

    <main class="px-6 md:px-10 pb-24">
        <!-- Controles -->
        <section id="controls" class="grid md:grid-cols-3 gap-3 md:gap-4 mb-4 items-end">
            <div class="col-span-1">
                <label for="search" class="text-sm text-slate-300">Busca por tópico/termo</label>
                <input id="search" type="search" placeholder="Pesquisar..."
                    class="w-full mt-1 bg-[var(--card)] border border-[var(--line)] rounded-xl px-4 py-2.5 focus:outline-none focus:ring-2 focus:ring-[var(--brand)]" />
                <p id="count" class="text-xs text-slate-400 mt-1" role="status" aria-live="polite"></p>
            </div>
            <div class="col-span-2 flex flex-wrap items-end gap-2 md:justify-end">
                <div class="tooltip">
                    <button id="btn-export"
                        class="px-4 py-2.5 rounded-xl bg-[var(--brand)] text-white font-semibold hover:opacity-95 shadow-soft">Exportar
                        CSV</button>
                    <div class="tip">Baixa o comparativo atual em CSV.</div>
                </div>
                <div class="tooltip">
                    <button id="btn-json"
                        class="px-4 py-2.5 rounded-xl bg-slate-700 hover:bg-slate-600 font-semibold">Exportar
                        JSON</button>
                    <div class="tip">Exporta com metadados: versão, colunas visíveis e data de geração.</div>
                </div>
                <div class="tooltip">
                    <button id="btn-print"
                        class="px-4 py-2.5 rounded-xl bg-slate-700 hover:bg-slate-600 font-semibold">Imprimir</button>
                    <div class="tip">Atalho <kbd>p</kbd> imprime a visualização atual.</div>
                </div>
                <details class="px-3 py-2 rounded-xl bg-[var(--card)] border border-[var(--line)]">
                    <summary class="cursor-pointer font-semibold">Colunas</summary>
                    <div class="mt-2 flex flex-wrap gap-3 text-sm">
                        <label class="inline-flex items-center gap-2"><input data-col="Free" type="checkbox"
                                class="toggle-col accent-[var(--brand)]" checked>Free</label>
                        <label class="inline-flex items-center gap-2"><input data-col="Starter" type="checkbox"
                                class="toggle-col accent-[var(--brand)]" checked>Starter</label>
                        <label class="inline-flex items-center gap-2"><input data-col="Pro" type="checkbox"
                                class="toggle-col accent-[var(--brand)]" checked>Pro</label>
                        <label class="inline-flex items-center gap-2"><input data-col="Scale" type="checkbox"
                                class="toggle-col accent-[var(--brand)]" checked>Scale</label>
                        <label class="inline-flex items-center gap-2"><input data-col="Business" type="checkbox"
                                class="toggle-col accent-[var(--brand)]" checked>Business</label>
                        <label class="inline-flex items-center gap-2"><input data-col="Enterprise" type="checkbox"
                                class="toggle-col accent-[var(--brand)]" checked>Enterprise</label>
                    </div>
                </details>
                <button id="btn-reset" class="px-3 py-2 rounded-xl border border-[var(--line)]">Resetar</button>
            </div>
        </section>

        <!-- Tabela -->
        <div class="rounded-2xl overflow-hidden border border-[var(--line)] bg-[var(--card)]">
            <div class="overflow-x-auto table-sticky">
                <table id="plansTable" class="min-w-full text-sm">
                    <thead>
                        <tr class="text-slate-300 border-b border-[var(--line)]">
                            <th scope="col" class="text-left p-3 md:p-4 w-56">
                                <div class="flex items-center gap-2">
                                    <span>Tópico</span>
                                    <button id="sortTopic" aria-label="Ordenar por tópico" aria-live="polite"
                                        class="text-xs px-2 py-1 border border-[var(--line)] rounded cell-badge">Ordenar
                                        ▲</button>
                                </div>
                            </th>
                            <!-- Cabeçalhos dinâmicos com tooltip inseridos via JS -->
                        </tr>
                    </thead>
                    <tbody id="tbody" class="divide-y divide-[var(--line)]"></tbody>
                </table>
            </div>
        </div>

        <p class="text-xs text-slate-400 mt-3">
            Resumo consolidado. “Scale” insere degrau entre Pro e Business. Preços e quotas conforme remodelagem mais
            recente.
        </p>

        <section class="mt-10 space-y-4 rounded-2xl border border-[var(--line)] bg-[var(--card)] p-6 shadow-soft">
            <h2 class="title text-2xl font-semibold text-slate-100">Melhorias sugeridas</h2>
            <ul class="list-disc space-y-3 pl-6 text-slate-300">
                <li><strong>Excedentes</strong>: blocos de 100/500 runs — Starter R$29/100, Pro R$25/100, Scale
                    R$23/100.</li>
                <li><strong>Anual</strong>: -15% (Starter/Pro/Scale) e -18% (Business) + bundles de ações (+2.000 por
                    R$120/mês no anual Business).</li>
                <li><strong>Scale</strong>: 1.000 runs, 2.000 ações, retenção 60d, webhooks básicos, suporte ≤24h.</li>
                <li><strong>Consultoria</strong>: 5h R$690 | 10h R$1.290 para Starter/Pro/Scale.</li>
                <li><strong>Agente</strong>: Medium (Starter/Pro/Scale), Core (Business), Guardian (Enterprise).</li>
            </ul>
        </section>
    </main>

    <script>
        (function () {
            const STORAGE = { query: "plans.v3.query", cols: "plans.v3.cols" };
            const ALL_COLS = ["Free", "Starter", "Pro", "Scale", "Business", "Enterprise"];

            // Tooltips de colunas e tópicos
            const COLUMN_TIPS = {
                Free: "Plano gratuito para makers e validação inicial.",
                Starter: "Times pequenos iniciando operação recorrente.",
                Pro: "Times em produção com maior cadência.",
                Scale: "Degrau entre Pro e Business. 1.000 runs, 2.000 ações, 60d.",
                Business: "Operação com integrações críticas e prioridade.",
                Enterprise: "Missão crítica. SSO/SCIM, TAM, SLA formal."
            };
            const TOPIC_TIPS = {
                "Preço": "Mensalidade padrão no ciclo mensal.",
                "Preço anual (-%)": "Pagamento anual com desconto embutido.",
                "Runs/mês": "Execuções computadas no mês. Reseta no próximo ciclo.",
                "Ações externas incluídas": "Chamadas externas, webhooks e integrações.",
                "Add-on excedentes": "Pacotes de runs adicionais por bloco.",
                "Preço excedente /100 runs": "Preço por bloco de 100 runs.",
                "Bundles de ações": "Ações extras em planos anuais.",
                "Agentes / Formulários": "Quantidade de agentes e formulários.",
                "Export / Dados": "Formatos e APIs de exportação.",
                "Webhooks": "Envio de eventos para endpoints do cliente.",
                "Logs & Retenção": "Janela de retenção e auditoria.",
                "Suporte": "Canais e SLO de atendimento.",
                "ICP (para quem é)": "Público-alvo do plano.",
                "Proposta de valor": "Benefício principal.",
                "Rituais/Coorte": "Rituais e sessões recorrentes.",
                "Onboarding/TTV": "Tempo até valor e passos iniciais.",
                "Checklists & Templates": "Materiais para adoção rápida.",
                "Observabilidade & Replay": "Monitoramento e reprocessamento.",
                "Conectores Datalake/ETL": "Integrações com lakes e ETL.",
                "SLA & Governança": "SLA e governança operacional.",
                "Consultoria sob demanda": "Horas de mentoria técnica.",
                "Recomendação de agente": "Agente sugerido por plano.",
                "Metas 30/60/90": "Objetivos por horizonte.",
                "Sinais de upgrade": "Gatilhos de migração de plano."
            };

            // Sanitização
            const escapeHTML = s => String(s ?? "").replace(/[&<>"']/g, m => ({ '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;' }[m]));
            const sanitize = s => escapeHTML(String(s ?? '').trim());

            // Dados
            const ROWS = [
                { topic: "Preço", values: { Free: "R$ 0", Starter: "R$ 49/mês", Pro: "R$ 149/mês", Scale: "R$ 299/mês", Business: "R$ 599/mês", Enterprise: "Sob proposta" } },
                { topic: "Preço anual (-%)", values: { Free: "—", Starter: "R$ 499/ano (-15%)", Pro: "R$ 1.519/ano (-15%)", Scale: "R$ 3.039/ano (-15%)", Business: "R$ 5.899/ano (-18%)", Enterprise: "Sob proposta" } },
                { topic: "Runs/mês", values: { Free: "20", Starter: "150", Pro: "500", Scale: "1.000", Business: "2.000", Enterprise: "10k+" } },
                { topic: "Ações externas incluídas", values: { Free: "0", Starter: "150", Pro: "1.000", Scale: "2.000", Business: "5.000", Enterprise: "25k+" } },
                { topic: "Add-on excedentes", values: { Free: "—", Starter: "Pacotes 100/500 runs", Pro: "Pacotes 100/500 runs", Scale: "Pacotes 100/500 runs", Business: "Custom", Enterprise: "Sob proposta" } },
                { topic: "Preço excedente /100 runs", values: { Free: "—", Starter: "R$ 29", Pro: "R$ 25", Scale: "R$ 23", Business: "Custom", Enterprise: "Sob proposta" } },
                { topic: "Bundles de ações", values: { Free: "—", Starter: "—", Pro: "—", Scale: "—", Business: "+2.000 por R$ 120/mês (anual)", Enterprise: "Sob proposta" } },
                { topic: "Agentes / Formulários", values: { Free: "2 agentes / 1 formulário", Starter: "5 agentes / 3 formulários", Pro: "Todos / Ilimitado", Scale: "Todos / Ilimitado", Business: "Todos / Ilimitado", Enterprise: "Todos / Ilimitado" } },
                { topic: "Export / Dados", values: { Free: "—", Starter: "CSV", Pro: "CSV/JSON + API", Scale: "CSV/JSON + API", Business: "Exports + Webhooks", Enterprise: "Datalake/ETL (Parquet/CSV/JSON)" } },
                { topic: "Webhooks", values: { Free: "—", Starter: "—", Pro: "Básico via API", Scale: "Básico (callback)", Business: "HMAC • retries • DLQ • idempotência", Enterprise: "HMAC • idempotência • retries • DLQ • auditoria" } },
                { topic: "Logs & Retenção", values: { Free: "7 dias", Starter: "15 dias", Pro: "30 dias", Scale: "60 dias", Business: "90 dias", Enterprise: "180–365+ dias" } },
                { topic: "Suporte", values: { Free: "Comunidade", Starter: "E-mail ≤48h", Pro: "E-mail ≤24h", Scale: "E-mail ≤24h + prioridade leve", Business: "Prioritário", Enterprise: "TAM + SLA (Sev1/Sev2)" } },
                { topic: "ICP (para quem é)", values: { Free: "Makers iniciantes", Starter: "Squads pequenos; PM/dev jr–pleno; agências", Pro: "Squads em produção; PM/dev pleno", Scale: "Squads crescendo com integrações", Business: "Times de ops/dados; integrações críticas", Enterprise: "Empresas com compliance, SSO/SCIM, lake/ETL" } },
                { topic: "Proposta de valor", values: { Free: "Do 0 ao 1º run em 7 min", Starter: "Fluxo em produção em 30 dias + mentoria", Pro: "Produção com confiança + Agente Core", Scale: "Escala inicial com webhooks básicos", Business: "Escala e confiabilidade com Exports + Webhooks", Enterprise: "Missão crítica com governança e SLA" } },
                { topic: "Rituais/Coorte", values: { Free: "Kickstart • Template Drop • Ship Friday", Starter: "Mentoria semanal + WhatsApp", Pro: "Mentoria semanal + WhatsApp Pro + Office Hours", Scale: "Mentoria quinzenal + WA", Business: "Mentoria quinzenal + deep-dives + Slack", Enterprise: "Mentoria quinzenal + consultoria + QBR" } },
                { topic: "Onboarding/TTV", values: { Free: "1º run em 7 min", Starter: "1º fluxo ≤30 min (meta 7d)", Pro: "≤30 min + 1 recomendação do Agente em 24h", Scale: "Wizard + callbacks básicos", Business: "Wizard: Webhook 10 min + Export 5–15 min", Enterprise: "Wizard + POC 4–6 sem (KPIs)" } },
                { topic: "Checklists & Templates", values: { Free: "Template 7 min", Starter: "Checklist Starter + template produção", Pro: "Checklist Pro + Templates Pro #1/#2", Scale: "Templates Scale + webhook básico", Business: "Blueprints Webhook/Export + runbooks", Enterprise: "Blueprints Enterprise + arquitetura lake/ETL" } },
                { topic: "Observabilidade & Replay", values: { Free: "Básico", Starter: "Boas práticas + troubleshooting", Pro: "Obs + Replay • Alertas", Scale: "Obs + Retry básico", Business: "Runbooks: P95/P99, DLQ, alarmes", Enterprise: "Métricas 2xx/4xx/5xx; auditoria" } },
                { topic: "Conectores Datalake/ETL", values: { Free: "—", Starter: "—", Pro: "—", Scale: "—", Business: "BI/ETL via exports", Enterprise: "S3/GCS/Azure; Snowflake/BQ/Redshift; dbt/Glue/Airflow" } },
                { topic: "SLA & Governança", values: { Free: "—", Starter: "≤48h úteis", Pro: "≤24h úteis", Scale: "≤24h úteis + prioridade leve", Business: "Prioritário (ex.: ≤12h)", Enterprise: "Sev1 ~4h • Sev2 ~12h • TAM • on-call" } },
                { topic: "Consultoria sob demanda", values: { Free: "—", Starter: "5h R$ 690 • 10h R$ 1.290", Pro: "5h R$ 690 • 10h R$ 1.290", Scale: "5h R$ 690 • 10h R$ 1.290", Business: "Sob medida", Enterprise: "Incluída no SOW" } },
                { topic: "Recomendação de agente", values: { Free: "—", Starter: "Medium", Pro: "Medium", Scale: "Medium", Business: "Core", Enterprise: "Guardian" } },
                { topic: "Metas 30/60/90", values: { Free: "Ativação/rituais comunidade", Starter: "300→700→1.200 assinantes", Pro: "400→900→1.500 • D30≥80%", Scale: "100→250→500 contas • D30≥75%", Business: "120→250→400 contas • 75% webhook", Enterprise: "6 POCs ativas • ≥60% win • 6–10 contratos" } },
                { topic: "Sinais de upgrade", values: { Free: "≥10–15 runs/sem por 2 sem", Starter: ">70% da franquia por 2 ciclos", Pro: "Runs>350 ou Ações>800/mês", Scale: "Uso de webhooks e retenção cheia", Business: "Runs>1.400 ou Ações>3.500/mês", Enterprise: "Exigência SSO/SCIM/ETL/SLA" } }
            ];

            // Estado
            const state = {
                visibleCols: loadVisibleCols(),
                sortAsc: true,
                filtered: []
            };

            // Elementos
            const searchEl = document.getElementById('search');
            const countEl = document.getElementById('count');
            const sortBtn = document.getElementById('sortTopic');
            const theadRow = document.querySelector('#plansTable thead tr');
            const tbody = document.getElementById('tbody');

            // Persistência colunas
            function loadVisibleCols() {
                try {
                    const raw = JSON.parse(localStorage.getItem(STORAGE.cols) || 'null');
                    if (Array.isArray(raw) && raw.length) return raw.filter(c => ALL_COLS.includes(c));
                } catch { }
                return ALL_COLS.slice();
            }
            function saveVisibleCols(cols) { localStorage.setItem(STORAGE.cols, JSON.stringify(cols)); }

            // Sincroniza toggles
            document.querySelectorAll('.toggle-col').forEach(cb => {
                cb.checked = state.visibleCols.includes(cb.dataset.col);
                cb.addEventListener('change', () => {
                    const col = cb.dataset.col;
                    if (cb.checked) { if (!state.visibleCols.includes(col)) state.visibleCols.push(col); }
                    else { state.visibleCols = state.visibleCols.filter(c => c !== col); if (!state.visibleCols.length) state.visibleCols = ALL_COLS.slice(); }
                    saveVisibleCols(state.visibleCols);
                    renderHeader(); renderBody(); updateCount();
                });
            });

            // Debounce
            function debounce(fn, ms) { let t; return (...a) => { clearTimeout(t); t = setTimeout(() => fn(...a), ms); }; }

            // Busca persistente
            const storedQ = localStorage.getItem(STORAGE.query) || '';
            searchEl.value = storedQ;

            // Filtro e ordenação
            function filterRows(q) {
                const s = String(q || '').toLowerCase();
                if (!s) return ROWS.slice();
                return ROWS.filter(r => r.topic.toLowerCase().includes(s) || ALL_COLS.some(c => (r.values[c] || '').toLowerCase().includes(s)));
            }
            function sortCurrent() { const dir = state.sortAsc ? 1 : -1; state.filtered.sort((a, b) => a.topic.localeCompare(b.topic, 'pt-BR') * dir); }

            // Render cabeçalho com tooltips de coluna
            function renderHeader() {
                while (theadRow.children.length > 1) theadRow.removeChild(theadRow.lastElementChild);
                state.visibleCols.forEach(col => {
                    const th = document.createElement('th');
                    th.scope = 'col'; th.dataset.col = col; th.className = 'p-3 md:p-4 text-left';
                    th.innerHTML = `
            <span class="tooltip" tabindex="0" aria-describedby="tip-col-${col}">
              <span>${sanitize(col)}</span>
              <span class="info-dot">i</span>
              <span id="tip-col-${col}" class="tip">${sanitize(COLUMN_TIPS[col] || '')}</span>
            </span>`;
                    theadRow.appendChild(th);
                });
            }

            // Render corpo com tooltip por tópico
            function renderBody() {
                tbody.innerHTML = '';
                state.filtered.forEach(row => {
                    const tr = document.createElement('tr');
                    const tdTopic = document.createElement('td');
                    tdTopic.className = 'align-top p-3 md:p-4 font-semibold text-slate-200';
                    tdTopic.innerHTML = `
            <span class="tooltip" tabindex="0" aria-describedby="tip-topic-${slug(row.topic)}">
              <span>${sanitize(row.topic)}</span>
              <span class="info-dot">i</span>
              <span id="tip-topic-${slug(row.topic)}" class="tip">${sanitize(TOPIC_TIPS[row.topic] || '')}</span>
            </span>`;
                    tr.appendChild(tdTopic);

                    state.visibleCols.forEach(col => {
                        const td = document.createElement('td');
                        td.dataset.col = col; td.className = 'p-3 md:p-4 text-slate-300';
                        td.textContent = sanitize(row.values[col] ?? '—');
                        tr.appendChild(td);
                    });
                    tbody.appendChild(tr);
                });
            }

            function slug(s) { return String(s).toLowerCase().replace(/[^a-z0-9]+/g, '-'); }
            function updateCount() { countEl.textContent = `${state.filtered.length} linha(s)`; }

            // Inicialização
            state.filtered = filterRows(storedQ); sortCurrent(); renderHeader(); renderBody(); updateCount();
            sortBtn.setAttribute('aria-sort', 'ascending');

            // Eventos
            searchEl.addEventListener('input', debounce(() => {
                localStorage.setItem(STORAGE.query, searchEl.value);
                state.filtered = filterRows(searchEl.value); sortCurrent(); renderBody(); updateCount();
            }, 140));

            sortBtn.addEventListener('click', () => {
                state.sortAsc = !state.sortAsc;
                sortBtn.textContent = `Ordenar ${state.sortAsc ? '▲' : '▼'}`;
                sortBtn.setAttribute('aria-sort', state.sortAsc ? 'ascending' : 'descending');
                sortCurrent(); renderBody();
            });

            // Exportações
            function visibleCols() { return state.visibleCols.slice(); }
            function toCSV() {
                const cols = ['Tópico', ...visibleCols()];
                const lines = [cols.join(',')];
                state.filtered.forEach(r => {
                    const arr = [r.topic, ...visibleCols().map(c => r.values[c] ?? '')].map(v => `"${String(v).replace(/"/g, '""')}"`);
                    lines.push(arr.join(','));
                });
                return lines.join('\n');
            }
            function toJSON() {
                const cols = visibleCols();
                return JSON.stringify({
                    version: 'v3',
                    generated_at: new Date().toISOString(),
                    visible_columns: cols,
                    rows: state.filtered.map(r => ({ topic: r.topic, values: Object.fromEntries(cols.map(c => [c, r.values[c] ?? ''])) }))
                }, null, 2);
            }
            document.getElementById('btn-export').addEventListener('click', () => {
                const blob = new Blob([toCSV()], { type: 'text/csv;charset=utf-8;' }), url = URL.createObjectURL(blob), a = document.createElement('a');
                a.href = url; a.download = 'comparativo-planos-eiah.csv'; a.click(); URL.revokeObjectURL(url);
            });
            document.getElementById('btn-json').addEventListener('click', () => {
                const blob = new Blob([toJSON()], { type: 'application/json;charset=utf-8;' }), url = URL.createObjectURL(blob), a = document.createElement('a');
                a.href = url; a.download = 'comparativo-planos-eiah.json'; a.click(); URL.revokeObjectURL(url);
            });

            // Reset
            document.getElementById('btn-reset').addEventListener('click', () => {
                localStorage.removeItem(STORAGE.query); localStorage.removeItem(STORAGE.cols);
                searchEl.value = ''; state.visibleCols = ALL_COLS.slice(); state.sortAsc = true;
                document.querySelectorAll('.toggle-col').forEach(cb => cb.checked = true);
                state.filtered = ROWS.slice(); sortCurrent(); renderHeader(); renderBody(); updateCount();
                sortBtn.textContent = 'Ordenar ▲'; sortBtn.setAttribute('aria-sort', 'ascending');
            });

            // Atalhos
            document.addEventListener('keydown', e => {
                if (e.key === '/' && document.activeElement !== searchEl) { e.preventDefault(); searchEl.focus(); }
                if (e.key.toLowerCase() === 'p') { e.preventDefault(); window.print(); }
                if (e.shiftKey && e.key.toLowerCase() === 'r') { e.preventDefault(); document.getElementById('btn-reset').click(); }
            });

            // Imprimir
            document.getElementById('btn-print').addEventListener('click', () => window.print());
        })();
    </script>
</body>

</html>